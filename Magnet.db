#############################################################################################
#record(stringin, "$(S):$(TA):$(DN):IDN") {
#  field(DESC, "Get the IDN string")
#  info(archive, "Monitor, 00:01:00")
#  field(DTYP, "stream")
#  field(INP, "@MagH.proto getIDN Magnet1")
#  field(PINI, "YES")
#}


record(seq, "$(S):$(TA):$(DN):COMSeq") {
  field(DESC, "Com Sequence")
  field(SCAN, "5 second")
  field(DOL1, "0.4")
  field(DLY1, "1")
  field(LNK1, "$(S):$(TA):$(DN):ReadkG.PROC")
  field(DOL2, "1")
  field(DLY2, "0.4")
  field(LNK2, "$(S):$(TA):$(DN):ReadVoltage.PROC")
  field(DOL3, "1")
  field(DLY3, "0.4")
  field(LNK3, "$(S):$(TA):$(DN):ReadOutCurrent.PROC")
  field(DOL4, "1")
  field(DLY4, "0.4")
  field(LNK4, "$(S):$(TA):$(DN):ReadOutVoltage.PROC")
  field(DOL5, "1")
  field(DLY5, "0.4")
  field(LNK5, "$(S):$(TA):$(DN):ReadError.PROC")
  field(DOL6, "1")
  field(DLY6, "0.4")
  field(LNK6, "$(S):$(TA):$(DN):ReadSTB.PROC")
  field(DOL7, "1")
  field(DLY7, "0.4")
  field(LNK7, "$(S):$(TA):$(DN):ReadSweep.PROC")
  field(FLNK, "$(S):$(TA):$(DN):COMSeq2")
}
record(seq, "$(S):$(TA):$(DN):COMSeq2") {
  field(DESC, "Com Sequence2")
  field(DOL1, "1")
  field(DLY1, "0.4")
  field(LNK1, "$(S):$(TA):$(DN):ReadUnits.PROC")
  field(DOL2, "1")
  field(DLY2, "0.4")
  field(LNK2, "$(S):$(TA):$(DN):ReadLowerSweepLimit.PROC")
  field(DOL3, "1")
  field(DLY3, "0.4")
  field(LNK3, "$(S):$(TA):$(DN):ReadVLimit.PROC")
  field(DOL4, "1")
  field(DLY4, "0.4")
  field(LNK4, "$(S):$(TA):$(DN):ReadUpperSweepLimit.PROC")
}

record(bo, "$(S):$(TA):$(DN):ReadRangesRates") {
  field(FLNK, "$(S):$(TA):$(DN):Ranges")	
  field(HIGH,"0.1")
}


record(seq, "$(S):$(TA):$(DN):Ranges") {
  field(DESC, "Get Ranges")
  field(PINI, "YES")
  field(DOL1, "0.4")
  field(DLY1, "1")
  field(LNK1, "$(S):$(TA):$(DN):ReadRange0.PROC ")
  field(DOL2, "1")
  field(DLY2, "0.4")
  field(LNK2, "$(S):$(TA):$(DN):ReadRange1.PROC")
  field(DOL3, "1")
  field(DLY3, "0.4")
  field(LNK3, "$(S):$(TA):$(DN):ReadRange2.PROC")
  field(DOL4, "1")
  field(DLY4, "0.4")
  field(LNK4, "$(S):$(TA):$(DN):ReadRange3.PROC")
  field(DOL5, "1")
  field(DLY5, "0.4")
  field(LNK5, "$(S):$(TA):$(DN):ReadRange4.PROC")
  field(FLNK, "$(S):$(TA):$(DN):Rates")
}

record(seq, "$(S):$(TA):$(DN):Rates") {
  field(DESC, "Get Rates")
  field(DOL1, "0.4")
  field(DLY1, "1")
  field(LNK1, "$(S):$(TA):$(DN):ReadRate0.PROC")
  field(DOL2, "1")
  field(DLY2, "0.4")
  field(LNK2, "$(S):$(TA):$(DN):ReadRate1.PROC")
  field(DOL3, "1")
  field(DLY3, "0.4")
  field(LNK3, "$(S):$(TA):$(DN):ReadRate2.PROC")
  field(DOL4, "1")
  field(DLY4, "0.4")
  field(LNK4, "$(S):$(TA):$(DN):ReadRate3.PROC")
  field(DOL5, "1")
  field(DLY5, "0.4")
  field(LNK5, "$(S):$(TA):$(DN):ReadRate4.PROC")
  field(DOL6, "1")
  field(DLY6, "0.4")
  field(LNK6, "$(S):$(TA):$(DN):ReadRate5.PROC")
}


record(ai, "$(S):$(TA):$(DN):ReadkG") {
  field(DESC, "Read the Field")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getFieldorCurrent Magnet1")
  field(EGU, "kG")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00, VAL HIHI LOLO")
  field(PREC, "3")
}

record(calc, "$(S):$(TA):$(DN):ReadField") {
  field(INPA, "$(S):$(TA):$(DN):ReadkG CPP MSS")
  field(CALC, "(A/10)")
  field(EGU, "T")
  field(HIHI, "5.1")
  field(LOLO, "-5.1")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00, VAL HIHI LOLO")
  field(PREC, "3")
}


record(calc, "$(S):$(TA):$(DN):ReadCurrent") {
  field(INPA, "$(S):$(TA):$(DN):ReadField CP")
  field(CALC, "A*51.7500")
  info(archive, "Monitor, 00:01:00, VAL")
  field(EGU, "A")
}


record(ai, "$(S):$(TA):$(DN):ReadVoltage") {
  field(DESC, "Read the Voltage")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getVoltage Magnet1")
  field(EGU, "V")
  field(HIHI, "100")
  field(LOLO, "-100")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00, VAL HIHI LOLO")
  field(PREC, "3")
}

record(ai, "$(S):$(TA):$(DN):ReadOutCurrent") {
  field(DESC, "Read the Output Current")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getOutputCurrent Magnet1")
  field(EGU, "A")
  field(HIHI, "1000")
  field(LOLO, "-1000")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00, VAL HIHI LOLO")
  field(PREC, "3")

}

record(ai, "$(S):$(TA):$(DN):ReadOutVoltage") {
  field(DESC, "Read the Output Voltage")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getOutputVoltage Magnet1")
  field(EGU, "V")
  field(HIHI, "100")
  field(LOLO, "-100")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00, VAL HIHI LOLO")
  field(PREC, "3")

}

record(bi, "$(S):$(TA):$(DN):ReadError") {
  field(DESC, "Error State")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getError Magnet1")
  info(archive, "Monitor, 00:01:00")
  field(ZNAM, "OK")
  field(ONAM, "ERROR")

}

record(mbbiDirect, "$(S):$(TA):$(DN):ReadSTB") {
  field(DESC, "Read Status Byte")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getSTB Magnet1")
  info(archive, "Monitor, 00:00:01, VAL")
}



record(stringin, "$(S):$(TA):$(DN):ReadSweep") {
  field(DESC, "Get Sweep State")
  info(archive, "Monitor, 00:01:00")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getSweep Magnet1")
}
#record below removed to prevent com overload
#record(stringin, "$(S):$(TA):$(DN):ReadMode") {
#  field(DESC, "Get Mode State")
#  info(archive, "Monitor, 00:01:00")
#  field(DTYP, "stream")
#  field(INP, "@MagH.proto getMode Magnet1")
#  field(SCAN, "1 second")
#}

#This magnet does not have a persistance switch        
#record(bi, "$(S):$(TA):$(DN):ReadPSwitch") {
#  field(DESC, "Read the Persistance Switch")
#  field(DTYP, "stream")
#  field(INP, "@MagH.proto getPSwitch Magnet1")
#  info(archive, "Monitor, 00:01:00")
#  field(ZNAM, "OFF")
#  field(ONAM, "ON")
#}

record(ai, "$(S):$(TA):$(DN):ReadRange0") {
  field(DESC, "Read the Range Limit0")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getRange0 Magnet1")
  field(EGU, "A")
  field(HIHI, "100")
  field(LOLO, "-100")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00, VAL HIHI LOLO")
  field(PREC, "4")
}

record(ai, "$(S):$(TA):$(DN):ReadRange1") {
  field(DESC, "Read the Range Limit1")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getRange1 Magnet1")
  field(EGU, "A")
  field(HIHI, "100")
  field(LOLO, "-100")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00, VAL HIHI LOLO")
  field(PREC, "4")
}

record(ai, "$(S):$(TA):$(DN):ReadRange2") {
  field(DESC, "Read the Range Limit2")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getRange2 Magnet1")
  field(EGU, "A")
  field(HIHI, "100")
  field(LOLO, "-100")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00, VAL HIHI LOLO")
  field(PREC, "4")
}


record(ai, "$(S):$(TA):$(DN):ReadRange3") {
  field(DESC, "Read the Range Limit3")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getRange3 Magnet1")
  field(EGU, "A")
  field(HIHI, "100")
  field(LOLO, "-100")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00, VAL HIHI LOLO")
  field(PREC, "4")

}

record(ai, "$(S):$(TA):$(DN):ReadRange4") {
  field(DESC, "Read the Range Limit4")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getRange4 Magnet1")
  field(EGU, "A")
  field(HIHI, "100")
  field(LOLO, "-100")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00, VAL HIHI LOLO")
  field(PREC, "4")

}

record(stringin, "$(S):$(TA):$(DN):ReadUnits") {
  field(DESC, "Read Units")
  info(archive, "Monitor, 00:01:00")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getUnits Magnet1")
}

record(ai, "$(S):$(TA):$(DN):ReadLowerSweepLimit") {
  field(DESC, "Read the Lower Seep Limit")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getLowerSweepLimit Magnet1")
  field(EGU, "kG")
  field(HIHI, "100")
  field(LOLO, "-100")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00, VAL HIHI LOLO")
  field(PREC, "3")
}

record(ai, "$(S):$(TA):$(DN):ReadRate0") {
  field(DESC, "Read the Rate 0")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getRate0 Magnet1")
  field(EGU, "A/Sec")
  field(HIHI, "100")
  field(LOLO, "-100")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00, VAL HIHI LOLO")
  field(PREC, "4")
}




record(ai, "$(S):$(TA):$(DN):ReadRate1") {
  field(DESC, "Read the Rate 1")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getRate1 Magnet1")
  field(EGU, "A/Sec")
  field(HIHI, "100")
  field(LOLO, "-100")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00, VAL HIHI LOLO")
  field(PREC, "4")
}





record(ai, "$(S):$(TA):$(DN):ReadRate2") {
  field(DESC, "Read the Rate 2")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getRate2 Magnet1")
  field(EGU, "A/Sec")
  field(HIHI, "100")
  field(LOLO, "-100")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00, VAL HIHI LOLO")
  field(PREC, "4")

}


record(ai, "$(S):$(TA):$(DN):ReadRate3") {
  field(DESC, "Read the Rate 3")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getRate3 Magnet1")
  field(EGU, "A/Sec")
  field(HIHI, "100")
  field(LOLO, "-100")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00, VAL HIHI LOLO")
  field(PREC, "4")

}

record(ai, "$(S):$(TA):$(DN):ReadRate4") {
  field(DESC, "Read the Rate 4")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getRate4 Magnet1")
  field(EGU, "A/Sec")
  field(HIHI, "100")
  field(LOLO, "-100")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00, VAL HIHI LOLO")
  field(PREC, "4")

}


record(ai, "$(S):$(TA):$(DN):ReadRate5") {
  field(DESC, "Read the Rate 5")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getRate5 Magnet1")
  field(EGU, "A/Sec")
  field(HIHI, "100")
  field(LOLO, "-100")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00, VAL HIHI LOLO")
  field(PREC, "4")

}

record(ai, "$(S):$(TA):$(DN):ReadUpperSweepLimit") {
  field(DESC, "Read Upper Sweep Limit")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getUpperSweepLimit Magnet1")
  field(EGU, "kG")
  field(HIHI, "100")
  field(LOLO, "-100")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00, VAL HIHI LOLO")
  field(PREC, "3")

}

record(ai, "$(S):$(TA):$(DN):ReadVLimit") {
  field(DESC, "Read Voltage Limit")
  field(DTYP, "stream")
  field(INP, "@MagH.proto getVLimit Magnet1")
  field(EGU, "V")
  field(HIHI, "6")
  field(LOLO, "-1")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00, VAL HIHI LOLO")
  field(PREC, "3")

}



######################################################
#Set Functions
######################################################
#This magnet does not have a persistance switch
#record(bo, "$(S):$(TA):$(DN):SetPSwitch") {
#  field(DESC, "Set Persistant Heater")
#  info(archive, "Monitor, 00:01:00")
#  field(DTYP, "stream")
#  field(OUT, "@MagH.proto setPersHeater Magnet1")
#}

record(bo, "$(S):$(TA):$(DN):SetLocalMode") {
  field(DESC, "Set Local Mode")
  field(DTYP, "stream")
  field(OUT, "@MagH.proto setLocal Magnet1")
  field(PINI, "YES")
  field(HIGH, "1")
  info(archive, "Monitor, 00:01:00")

}

record(bo, "$(S):$(TA):$(DN):SetUnits") {
  field(DESC, "Set Units to kG")
  field(VAL, "0")
  field(DTYP, "stream")
  field(OUT, "@MagH.proto setUnits Magnet1")
  field(PINI, "YES")
  field(HIGH, "1")
  info(archive, "Monitor, 00:01:00")

}

record(ao, "$(S):$(TA):$(DN):SetVoltLimit") {
  field(DESC, "Set Voltage Limit")
  field(EGU, "V")
  field(HIHI, "5")
  field(LOLO, "0")
  field(HOPR, "5")
  field(LOPR, "0")
  field(DRVH, "5")
  field(DRVL, "0")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00")
  field(DTYP, "stream")
  field(OUT, "@MagH.proto setVoltageLimit Magnet1")
  field(PREC, "3")
}

###########################SETPOINT
record(ao, "$(S):$(TA):$(DN):SP") {
  field(DESC, "Set Field")
  field(EGU, "T")
  field(HIHI, "5.0")
  field(LOLO, "-5.0")
  field(HOPR, "5.0")
  field(LOPR, "-5.0")
  field(DRVH, "5.0")
  field(DRVL, "-5.0")
  info(autosaveFields, "VAL HIHI LOLO")
  info(archive, "Monitor, 00:01:00")
  field(PREC, "3")
}


record(calc, "$(S):$(TA):$(DN):SPtoKG") {
  field(INPA, "$(S):$(TA):$(DN):SP CPP MSS")
  field(CALC, "(A*10)")
  field(FLNK, "$(S):$(TA):$(DN):SPCheck")
}

record(calc, "$(S):$(TA):$(DN):SPCheck") {
  field(INPA, "$(S):$(TA):$(DN):SPtoKG")
  field(CALC, "A=0?1:(A>0)&(A<=50)?2:(A<0)&(A>=-50)?3:0")
  field(FLNK, "$(S):$(TA):$(DN):SPSelect")
}


record(seq, "$(S):$(TA):$(DN):SPSelect") {
   field(SELM, "Specified")
   field(SELL, "$(S):$(TA):$(DN):SPCheck")
   field(DO1, "3")
   field(LNK1, "$(S):$(TA):$(DN):SetSweepMode CPP NMS") 
   field(DO2, "1")
   field(LNK2, "$(S):$(TA):$(DN):SPUP.PROC CPP NMS")
   field(DOL3, "1")
   field(LNK3, "$(S):$(TA):$(DN):SPDOWN.PROC CPP NMS")
}

record(seq, "$(S):$(TA):$(DN):SPUP") {
   field(DOL1, "$(S):$(TA):$(DN):SPtoKG")
   field(LNK1, "$(S):$(TA):$(DN):SetUpperSweepLimit CPP NMS")
   field(DLY1, "1")
   field(DO1, "0")
   field(LNK2, "$(S):$(TA):$(DN):SetSweepMode CPP NMS")
   field(DLY2, "5")
}

record(seq, "$(S):$(TA):$(DN):SPDOWN") {
   field(DOL1, "$(S):$(TA):$(DN):SPtoKG")
   field(LNK1, "$(S):$(TA):$(DN):SetLowerSweepLimit CPP NMS")
   field(DLY1, "1")
   field(DO2, "1")
   field(LNK2, "$(S):$(TA):$(DN):SetSweepMode CPP NMS")
   field(DLY2, "5")
}

record(ao, "$(S):$(TA):$(DN):SetUpperSweepLimit") {
  field(DESC, "Set Upper Sweep Limit")
  field(EGU, "kG")
  field(HIHI, "50")
  field(LOLO, "0")
  field(HOPR, "50")
  field(LOPR, "0")
  field(DRVH, "50")
  field(DRVL, "0")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00")
  field(DTYP, "stream")
  field(OUT, "@MagH.proto setUpperSweepLimit Magnet1")
  field(PREC, "3")
}

record(ao, "$(S):$(TA):$(DN):SetLowerSweepLimit") {
  field(DESC, "Set Lower Seeep Limit")
  field(EGU, "kG")
  field(HIHI, "0")
  field(LOLO, "-50")
  field(HOPR, "0")
  field(LOPR, "-50")
  field(DRVH, "0")
  field(DRVL, "-50")
  info(autosaveFields, "HIHI LOLO")
  info(archive, "Monitor, 00:01:00")
  field(DTYP, "stream")
  field(OUT, "@MagH.proto setLowerSweepLimit Magnet1")
  field(PREC, "3")
}

record(mbbo, "$(S):$(TA):$(DN):SetSweepMode") {
  field(DESC, "Set Sweep Mode")
  field(ZRST, "Set Upper SP")
  field(ONST, "Set Lower SP")
  field(TWST, "Pause")
  field(THST, "Zero")
  info(archive, "Monitor, 00:01:00")
  field(DTYP, "stream")
  field(OUT, "@MagH.proto setSweep Magnet1")
}
